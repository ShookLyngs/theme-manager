!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash"),require("react")):"function"==typeof define&&define.amd?define(["exports","lodash","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["themer-react"]={},e.lodash,e.React)}(this,(function(e,t,n){"use strict";var r=Object.assign;function o(e,t=[],n={}){return Object.keys(e).reduce(((r,a)=>{const c=e[a],s=[...t,a];return"string"==typeof c?r[s.join("-")]=c:r=o(c,s,n),r}),n)}function a(e){const t=function(t){let n,r=function(){try{return document.querySelector(":root")||void 0}catch(e){return}}(),o=[];if(Array.isArray(t)){if(!t.length)throw new Error("'themes' must be filled");o=[...t]}else if(a=t,"[object Object]"===Object.prototype.toString.apply(a)){const{element:e,themes:n}=t;r&&(r=e),Array.isArray(o)&&(o=n)}var a;n=o[0];const s={element:r,themes:o,theme:n};return r&&c(s,o[0]),s}(e);return t.setTheme=e=>c(t,e),t}function c(e,n){if(console.log("setTheme: ",e,n),"string"==typeof n){const t=e.themes.find((e=>e.value.name===n));if(!t)return!1;n=t}const a=function(e){const{colors:t}=e.value.data;return r({},t)}(n=t.cloneDeep(n));return!!e.element&&(function(e,t){if(!e)return;const n=o(t);Object.keys(n).forEach((t=>{e.style.setProperty(function(e){const t=String(e);return t.startsWith("--")?t:`--${t}`}(t),n[t])}))}(e.element,a),e.themeValueUpdater instanceof Function?e.themeValueUpdater(n):e.theme.value=n.value,!0)}const s=new Map;e.createTheme=function(e){return{value:e instanceof Function?e():e}},e.createThemeManager=function(e){const t=`${Date.now()}`;return s.set(t,{origin:a(e)}),console.log("Created ThemeManager: ",s.get(t)),t},e.useThemeManager=function(e){const t=s.get(e);if(!t)throw new Error("You need to create ThemeManager before calling it.");const r=Reflect.has(t,"instance")?t.instance:t.origin,[o,a]=n.useState(r.theme.value);return r.theme.value=o,r.themeValueUpdater=e=>a(e.value),n.useEffect((()=>{console.log("state updated: ",o)})),t.instance=r,r},Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
